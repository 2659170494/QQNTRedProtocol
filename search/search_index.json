{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"RedProtocol","text":"<p>\u6b64\u4ed3\u5e93\u9610\u660e\u4e86\u5173\u4e8e BetterQQNT \u529f\u80fd RedProtocol \u7684\u534f\u8bae\u7ec6\u5219\u3002</p>"},{"location":"#1","title":"1. \u57fa\u672c","text":"<p>RedProtocol \u63d0\u4f9b\u65b9\u4f1a\u63d0\u4f9b\u4e00\u4e2a WebSocket \u548c HTTP \u5408\u5e76\u7684\u670d\u52a1\uff0c\u5f53\u524d\u9ed8\u8ba4\u6253\u5f00\u5728\u672c\u673a\u7aef\u53e3 16530\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a <code>--red-protocol-port</code> \u53c2\u6570\u6765\u66f4\u6539\u7aef\u53e3\u53f7\u3002</p> <p>RedProtocol \u4f7f\u7528\u6570\u5b57 ID\uff08Uin\uff09\u3002</p> <p>WebSocket \u90e8\u5206\uff1a<code>ws://localhost:16530/</code> HTTP \u90e8\u5206\uff1a<code>http://localhost:16530/api/</code></p>"},{"location":"#11","title":"1.1 \u8ba4\u8bc1","text":"<p>TOKEN \u88ab\u9ed8\u8ba4\u5b58\u50a8\u5728 <code>%AppData%/BetterUniverse/QQNT/RED_PROTOCOL_TOKEN</code> \u6216 <code>~/BetterUniverse/QQNT/RED_PROTOCOL_TOKEN</code>\u3002</p> <p>\u82e5\u65e0 TOKEN \uff0c\u5728\u542f\u7528 RedProtocol \u65f6\u5c06\u4f1a\u81ea\u52a8\u751f\u6210\u3002</p> <p>\u8ba4\u8bc1\u65b9\u5f0f\uff1a</p> <p>WebSocket:</p> <p><code>meta::connect</code> \u5305</p> <p>HTTP:</p> <p>\u6bcf\u6b21\u8bf7\u6c42\u65f6\uff0c\u5728 HEADER \u5185\u643a\u5e26 <code>Authorization</code>\uff1a <code>Bearer TOKEN</code></p>"},{"location":"#2-websocket","title":"2. WebSocket \u5305","text":"<p>\u6ce8\u610f\uff1a\u6b64\u90e8\u5206\u4f7f\u7528\u7684 JSON \u90fd\u4e3a\u7c7b TypeScript \u7684\u7b80\u5199\uff0c\u8bf7\u4f20\u5165\u6b63\u786e\u7684 JSON \u800c\u4e0d\u662f\u6b64\u7c7b\u7b80\u5199</p> <p>\u89c1 WebSocket \u90e8\u5206</p>"},{"location":"#3-http-api","title":"3. HTTP API","text":"<p>\u6ce8\u610f\uff1a\u6b64\u90e8\u5206\u4f7f\u7528\u7684 JSON \u90fd\u4e3a\u7c7b TypeScript \u7684\u7b80\u5199\uff0c\u8bf7\u4f20\u5165\u6b63\u786e\u7684 JSON \u800c\u4e0d\u662f\u6b64\u7c7b\u7b80\u5199</p> <p>\u89c1 HTTP \u90e8\u5206</p>"},{"location":"http/","title":"HTTP","text":""},{"location":"http/#bot","title":"Bot \u4fe1\u606f","text":""},{"location":"http/#_1","title":"\u81ea\u8eab\u4fe1\u606f","text":"<p>GET /api/getSelfProfile</p>"},{"location":"http/#_2","title":"\u597d\u53cb\u5217\u8868","text":"<p>GET /api/bot/friends</p> <p>Response: type.info.User[]</p> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.info</p>"},{"location":"http/#_3","title":"\u7fa4\u5217\u8868","text":"<p>GET /api/bot/groups</p> <p>Response: type.info.Group[]</p> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.info</p>"},{"location":"http/#_4","title":"\u7fa4\u7ec4\u76f8\u5173","text":""},{"location":"http/#_5","title":"\u8bbe\u7f6e\u5168\u4f53\u7981\u8a00","text":"<p>POST /api/group/muteEveryone</p> <pre><code>{\n    group: 233333, // \u7fa4\u53f7\n    enable: true // \u662f\u5426\u5f00\u542f\n}\n</code></pre>"},{"location":"http/#_6","title":"\u8e22\u4eba","text":"<p>POST /api/group/kick</p> <pre><code>{\n    uidList: [1234567],\n    group: 233333, // \u7fa4\u53f7\n    refuseForever: false, // \u6c38\u8e22\n    reason: '\u539f\u56e0'\n}\n</code></pre>"},{"location":"http/#_7","title":"\u83b7\u53d6\u7fa4\u516c\u544a","text":"<p>POST /api/group/getAnnouncements</p> <pre><code>{\n    group: 233333, // \u7fa4\u53f7\n}\n</code></pre>"},{"location":"http/#_8","title":"\u83b7\u53d6\u6210\u5458\u5217\u8868","text":"<p>POST /api/group/getMemberList</p> <pre><code>{\n    group: 233333, // \u7fa4\u53f7\n    size: 20 // \u4e2a\u6570\n}\n</code></pre>"},{"location":"http/#_9","title":"\u6d88\u606f\u76f8\u5173","text":""},{"location":"http/#_10","title":"\u62c9\u53d6\u5bcc\u5a92\u4f53\u6d88\u606f\u5185\u5bb9","text":"<p>POST /api/message/fetchRichMedia</p> <pre><code>{\n    \"msgId\": \"7253238687216318972\", // \u6d88\u606f ID\n    \"chatType\": 2, // Peer \u7c7b\u578b\n    \"peerUid\": \"390197947\", // Peer ID\n    \"elementId\": \"7253238687216318971\", // \u5bcc\u5a92\u4f53\u6d88\u606f\u5143\u7d20 ID\n    \"thumbSize\": 0, // \u7167\u4f20\u5373\u53ef\n    \"downloadType\": 2 // \u7167\u4f20\u5373\u53ef\n}\n</code></pre> <p>Response: \u76f4\u63a5\u8fd4\u56de\u5bf9\u5e94\u6d88\u606f\u5143\u7d20\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\uff1b\u5982\uff1a\u56fe\u7247\u5373\u8fd4\u56de\u56fe\u7247\u4e8c\u8fdb\u5236</p>"},{"location":"http/#_11","title":"\u4e0a\u4f20\u5bcc\u5a92\u4f53\u6d88\u606f\u5185\u5bb9","text":"<p>POST /api/upload</p> <p>body: FormData file=[\u6587\u4ef6]</p> <p>Response: \u53d1\u9001\u5bcc\u5a92\u4f53\u6d88\u606f\u6240\u9700\u7684\u6240\u6709\u4fe1\u606f\uff0c\u5728 <code>message::send</code> \u5305\u4e2d\u5408\u5e76\u5230 payload.elements \u5373\u53ef\u3002</p>"},{"location":"http/#_12","title":"\u64a4\u56de","text":"<p>POST /api/message/recall</p> <pre><code>{\n    msgIds: ['7251111111111122069'], // \u4f9d\u7136\u4e0d\u5efa\u8bae\u4e00\u6b21\u4f20\u592a\u591a \u8fd8\u662f\u4f1a\u5931\u8d25\u7684\n    peer: type.peer.Peer\n}\n</code></pre> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.peer</p>"},{"location":"http/#_13","title":"\u83b7\u53d6\u5386\u53f2\u6d88\u606f","text":"<p>POST /api/message/getHistory</p> <pre><code>{\n    peer: type.peer.Peer,\n    offsetMsgId?: number, // \u504f\u79fb\uff0c\u4ece\u54ea\u6761\u5f00\u59cb\n    count: 100 // \u6570\u91cf\n}\n</code></pre> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.peer</p>"},{"location":"websocket/","title":"WebSocket","text":""},{"location":"websocket/#_1","title":"\u5305\u683c\u5f0f","text":"<pre><code>{\n    type: 'meta::connect', // \u5305\u7c7b\u578b\n    payload: { // \u5305\u8f7d\u8377\n\n    }\n}\n</code></pre> <p>\u4f8b\u5982\uff1a\u5f53\u4f60\u60f3\u53d1\u9001\u4e00\u4e2a\u7c7b\u578b\u4e3a <code>meta::connect</code>\uff0c\u8f7d\u8377\u4e3a <code>{ \"token\": \"123456\" }</code> \u7684\u5305\uff0c\u4f60\u9700\u8981\u53d1\u9001\uff1a</p> <pre><code>{\n    \"type\": \"meta::connect\",\n    \"payload\": { \n       \"token\": \"123456\"\n    }\n}\n</code></pre>"},{"location":"websocket/#_2","title":"\u5305\u7c7b\u578b","text":"<p>\u4ee5\u4e0b \u2b07\ufe0f \u8868\u793a \u63d0\u4f9b\u65b9 \u4e0b\u53d1\u5230 \u5ba2\u6237\u7aef \u7684\u5305\uff0c\u2b06\ufe0f \u8868\u793a \u5ba2\u6237\u7aef \u4e0a\u53d1\u5230 \u63d0\u4f9b\u65b9 \u7684\u5305\u3002</p> <p>type.filename.interface \u8868\u793a\u4e3a\u6b64\u90e8\u5206\u7684\u5b9a\u4e49\u5b58\u5728\u4e8e <code>filename</code> \u6587\u4ef6\u5185\u7684\u5bf9\u5e94 <code>interface</code> \u4e2d\u3002</p>"},{"location":"websocket/#metaconnect","title":"<code>meta::connect</code> \u2b07\ufe0f","text":"<p>\u8fde\u63a5\u5230 WebSocket \u5ba2\u6237\u7aef</p> <pre><code>{\n  token: \"TOKEN\"\n}\n</code></pre>"},{"location":"websocket/#metaconnect_1","title":"<code>meta::connect</code> \u2b06\ufe0f","text":"<p>\u53d1\u56de\u534f\u8bae\u7aef\u4fe1\u606f</p> <pre><code>{\n    version: '1.0.0',\n    name: 'red-protocol',\n    authData: type.auth.AuthData\n}\n</code></pre> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.auth</p>"},{"location":"websocket/#messagerecv","title":"<code>message::recv</code> \u2b07\ufe0f","text":"<p>\u63a5\u6536\u6d88\u606f</p> <pre><code>type.message.Message\n</code></pre> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.message</p>"},{"location":"websocket/#messagesend","title":"<code>message::send</code> \u2b06\ufe0f","text":"<p>\u53d1\u9001\u6d88\u606f</p> <pre><code>{\n    peer: type.peer.Peer,\n    elements: type.message.Element[]\n}\n</code></pre> <p>\u76f8\u5173\u94fe\u63a5\uff1a</p> <p>type.message</p> <p>type.peer</p> <p>\u4f7f\u7528\u4f8b\uff1aissue/1</p>"}]}